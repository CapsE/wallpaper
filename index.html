<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wallpaper</title>
</head>
<body>
<canvas id="wrapper">

</canvas>

<script src="jquery-3.1.1.min.js"></script>
<script src="perlin.js"></script>
<script>
    var tailLength = 100;
    var offset = 0;
    var countX = window.innerWidth;
    var countY = window.innerHeight;
    var ctx = document.getElementById("wrapper").getContext("2d");
    var x = Math.random() * countX;
    var y = Math.random() * countY;
    var lastX = x;
    var lastY = y;
    var speed = 0.25;
	var colorSpeed = 0.25;
    $(document).ready(function(){

        var $body = $("#wrapper");
        noise.seed(Math.random());
        $("#wrapper").attr("width", countX);
        $("#wrapper").attr("height", countY);
        setInterval(function () {
            step();
        }, 10);

        ctx.fillStyle="#FAFAFA";
        ctx.fillRect(0,0,countX, countY);
    });

    function step() {
        offset++;
        var r = parseInt(((noise.simplex3((offset) / (200/colorSpeed), 1000, 0) +1)/2)*140);

        var h = parseInt(((noise.simplex3((offset + 1000) / (1000/colorSpeed), 1000, 0) +1)/2)*360);
        var h2 = (h + r + 180)%360;


        ctx.fillStyle='hsl('+ h +',75%,50%)';
        ctx.fillRect(0,0,countX, countY);

        for(var i = 0; i < tailLength; i+=10){
            ctx.fillStyle="hsla(" + h2 + ",75%, 50%," + (1/tailLength) * i + ")";
            x =  ((noise.simplex2((offset + i ) / (200/speed), 300)) + 1) /2*countX;
            y =  ((noise.simplex2((offset + i ) / (200/speed), 400)) + 1) /2*countY;
            ctx.beginPath();
            ctx.arc(x,y,50,0,2*Math.PI);
            ctx.fill();

            x =  ((noise.simplex2((offset + i + 5) / (200/speed), 300.05)) + 1) /2*countX;
            y =  ((noise.simplex2((offset + i + 5) / (200/speed), 400.05)) + 1) /2*countY;
            ctx.beginPath();
            ctx.arc( x, y,50,0,2*Math.PI);
            ctx.fill();

            x =  ((noise.simplex2((offset + i + 10) / (200/speed), 300.1)) + 1) /2*countX;
            y =  ((noise.simplex2((offset + i + 10) / (200/speed), 400.1)) + 1) /2*countY;
            ctx.beginPath();
            ctx.arc(x,  y,50,0,2*Math.PI);
            ctx.fill();
            x =  ((noise.simplex2((offset + i + 15) / (200/speed), 300.15)) + 1) /2*countX;
            y =  ((noise.simplex2((offset + i + 15) / (200/speed), 400.15)) + 1) /2*countY;
            ctx.beginPath();
            ctx.arc( x,  y,50,0,2*Math.PI);
            ctx.fill();
        }
    }

    $(document).click(function(){
        step();
    });

</script>
<style>
    html, body{
        padding:0px;
        margin:0px;
        width:100%;
        height:100%;
        overflow:hidden;
    }

    @keyframes rotate {
       0%{ transform: rotate(0deg)}
       100%{ transform: rotate(360deg)}
    }
</style>
</body>
</html>